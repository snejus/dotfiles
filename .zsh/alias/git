alias -g csu=--compact-summary

alias ga='git add'
alias gac='git add $(gf)'
alias gau='git add -u'
alias gc='git checkout'
alias gc-='git checkout -'
alias gci='hub ci-status'
alias gcb='git checkout -b'
alias gcm='git checkout master'
alias gct='git checkout -t'
alias gce='git commit --no-edit --amend'
alias gcom='git commit -m'
alias gdm='git diff master'
alias gds='git diff --staged'
alias gd='git diff'
alias gfe='git fetch --all'
alias ghrc='gh repo clone'
alias gprc='gh pr create'
alias gl='git l'
alias gll='git ll'
alias gla='git la'
alias gls='git ls'
alias glsa='git lsa'
alias glc='git lc'
alias glca='git lca'
alias glf='git lf'
alias glfa='git lfa'
alias glp='git lp'
alias glpa='git lpa'
alias glse='git lf -S'
alias gm='git merge'
alias gmom='git merge origin/master'
alias gp='git push'
alias gpou='git push origin -u'
alias grb='git rebase'
alias grbc='git rebase --continue'
alias gre='git restore'
alias gres='git restore --staged'
alias gresc='git restore --staged $(gf)'
alias grec='git restore $(gf)'
alias grs='git reset'
alias grh='git reset --hard HEAD'
alias grl='git rl'
alias groot='cd $(git rev-parse --show-cdup)'
alias grpo='git remote prune origin'
alias gs='gstatus'
alias gst='git stash'
alias gstat='hub ci-status --format="%n%sC%S %t%n" -v'
alias gstp='git stash pop'
alias gstl='git stash list | pygmentize -l yaml -O style=fruity'
alias gnew='git diff --name-only --diff-filter=d 2>/dev/null | xargs bat --diff --diff-context=2'
alias gitinspection='gitinspector --file-types="**" --grading -T --format html > gitinspector.html && $BROWSER gitinspector.html'
alias openpr='gh pr view --web'
alias openbuild='$BROWSER $(hub ci-status -f "%U")'

prmsg() {
    if [[ -n $1 ]]; then
        pr_index="$1"
    else
        pr_index=$(hub pr list -L1 -f '%I%n')
    fi

    patlogin='[^-][a-z-]\+'
    pname=$(git remote get-url origin | sed -n "s/.*:\(.*\)\..*\|$/\1/p")
    prurl="https://api.github.com/repos/$pname/pulls/$pr_index"
    paste -sz <(curl -s -u "username:$GITHUB_TOKEN" "$prurl/reviews") \
              <(curl -s -u "username:$GITHUB_TOKEN" "$prurl/comments") |
        jq '.[]? | .user.login, .body, .diff_hunk[0:200]' | # select fields, trim diff hunks
        tr -d "'" |             # trim single quotes
        sed 's/^"\|"$//g; # trim double quotes from startend
             s/@@/\n&/' |       # newline before diff
        sed "s/^$patlogin$/\n\n\n\\\e[1;3;34m&\\\e[0m/" | # 3 new lines before login and make it blue
        xargs -0 echo -e {} |   # expand diff newlines
        diff-so-fancy |         # color it
        fold -w 100 |           # and restrict the width
        less -XLR
}

# vim:ft=bash
